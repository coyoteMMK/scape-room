<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal de Nochebuena</title>

  <style>
    :root {
      --bg1:#0b1020; --bg2:#120a1a;
      --text:#eef2ff; --muted:#b8c0ff;
      --danger:#ff5a7a; --ok:#66ffcc;
    }
    * { box-sizing: border-box; }

    body {
      margin:0; min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 20% 10%, #2a1a5c 0%, transparent 60%),
        radial-gradient(700px 500px at 80% 20%, #3a0f2b 0%, transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      display:flex;
      align-items:center;
      justify-content:center;
      transition: background 1s ease;
    }

    /* CONTENEDOR PRINCIPAL */
    #portal {
      width:100%;
      max-width:900px;
      padding:24px;
    }

    .card {
      background:#121a33cc;
      border-radius:20px;
      padding:28px;
    }

    h1 { margin:0 0 18px 0; text-align:center; }

    .inputs {
      display:flex;
      justify-content:center;
      gap:12px;
      margin-bottom:18px;
    }

    .pin {
      width:58px; height:64px;
      font-size:28px;
      text-align:center;
      border-radius:16px;
      border:1px solid #ffffff1f;
      background:#0b1330cc;
      color:var(--text);
    }

    .actions {
      display:flex;
      justify-content:center;
      gap:12px;
      margin-bottom:12px;
    }

    button {
      padding:12px 18px;
      border-radius:14px;
      border:none;
      cursor:pointer;
      font-weight:700;
      color:white;
      background:linear-gradient(135deg,#7c5cff,#ff4fd8);
    }

    .ghost {
      background:transparent;
      border:1px solid #ffffff1f;
    }

    .msg {
      text-align:center;
      min-height:22px;
    }
    .msg.error { color:var(--danger); }
    .msg.ok { color:var(--ok); }

    /* FINAL LIMPIO */
    #finalScreen {
      display:none;
      width:100%;
      height:100vh;
      align-items:center;
      justify-content:center;
    }

    #finalCode {
      font-size:72px;
      font-weight:900;
      letter-spacing:14px;
    }

    video {
      display:none;
    }
  </style>
</head>

<body>

<div id="portal">
  <div class="card" id="card">
    <h1>Introduce el código de 6 dígitos</h1>

    <div class="inputs">
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
    </div>

    <div class="actions">
      <button id="checkBtn">Abrir portal</button>
      <button id="clearBtn" class="ghost">Borrar</button>
    </div>

    <div class="msg" id="msg"></div>
  </div>
</div>

<!-- PANTALLA FINAL LIMPIA -->
<div id="finalScreen">
  <div id="finalCode">591</div>
</div>

<!-- VIDEO OCULTO -->
<video id="video">
  <source src="outro.mp4" type="video/mp4">
</video>

<script>
  const SECRET_6 = "220701";
  const FINAL_3 = "591";
  let tries = 3;

  const inputs = [...document.querySelectorAll(".pin")];
  const msg = document.getElementById("msg");
  const portal = document.getElementById("portal");
  const finalScreen = document.getElementById("finalScreen");
  const finalCode = document.getElementById("finalCode");
  const video = document.getElementById("video");

  function getCode() {
    return inputs.map(i => i.value).join("");
  }

  function clearAll() {
    inputs.forEach(i => i.value = "");
    inputs[0].focus();
  }

  async function playVideo() {
    video.style.display = "block";
    video.currentTime = 0;

    try {
      if (video.requestFullscreen) await video.requestFullscreen();
      else if (video.webkitRequestFullscreen) video.webkitRequestFullscreen();
    } catch(e){}

    await video.play();

    video.onended = () => {
      if (document.fullscreenElement) document.exitFullscreen();
      video.pause();
      video.style.display = "none";

      // LIMPIEZA TOTAL
      portal.style.display = "none";
      finalCode.textContent = FINAL_3;
      finalScreen.style.display = "flex";
    };
  }

  document.getElementById("checkBtn").onclick = async () => {
    if (getCode().length < 6) {
      msg.textContent = "Completa los 6 dígitos";
      msg.className = "msg error";
      return;
    }

    if (getCode() === SECRET_6) {
      msg.textContent = "¡Correcto!";
      msg.className = "msg ok";
      await playVideo();
    } else {
      tries--;
      msg.textContent = "Código incorrecto";
      msg.className = "msg error";
      clearAll();
      if (tries <= 0) {
        msg.textContent = "Portal bloqueado";
        inputs.forEach(i => i.disabled = true);
      }
    }
  };

  document.getElementById("clearBtn").onclick = clearAll;

  inputs.forEach((input, i) => {
    input.oninput = () => {
      input.value = input.value.replace(/\D/g,"");
      if (input.value && i < inputs.length - 1) inputs[i + 1].focus();
    };
  });

  inputs[0].focus();
</script>

</body>
</html>
