<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal de Nochebuena</title>

  <style>
    :root {
      --bg1:#0b1020; --bg2:#120a1a;
      --card:#121a33cc; --border:#ffffff1f;
      --text:#eef2ff; --muted:#b8c0ff;
      --danger:#ff5a7a; --ok:#66ffcc;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 20px;
    }
    * { box-sizing: border-box; }
    body {
      margin:0; min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 20% 10%, #2a1a5c 0%, transparent 60%),
        radial-gradient(700px 500px at 80% 20%, #3a0f2b 0%, transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      display:flex; align-items:center; justify-content:center;
      padding:24px;
    }
    .wrap { width:min(920px, 100%); }
    .topbar {
      display:flex; justify-content:space-between; align-items:center;
      gap:16px; margin-bottom:14px;
    }
    .badge {
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border:1px solid var(--border);
      background:#0b1330b0; border-radius:999px;
    }
    .dot {
      width:10px; height:10px; border-radius:999px; background:var(--muted);
    }
    .card {
      border:1px solid var(--border);
      background:var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .hero {
      padding:28px 28px 18px 28px;
    }
    h1 { margin:0; font-size: 28px; }

    .inputs {
      padding: 12px 28px 26px 28px;
      display:flex; gap:12px; flex-wrap:wrap;
    }
    .pin {
      width: 58px; height: 64px;
      border-radius: 16px;
      border:1px solid var(--border);
      background:#0b1330cc;
      color:var(--text);
      font-size:28px;
      text-align:center;
    }

    .actions {
      padding: 0 28px 28px 28px;
      display:flex; gap:12px;
    }
    button {
      border:none;
      padding:12px 16px;
      border-radius: 14px;
      background: linear-gradient(135deg, #7c5cff, #ff4fd8);
      color:white; font-weight:650;
      cursor:pointer;
    }
    .ghost {
      background: transparent;
      border:1px solid var(--border);
      color:var(--text);
    }

    .msg {
      min-height: 22px;
      padding: 0 28px 20px 28px;
    }
    .msg.error { color: var(--danger); }
    .msg.ok { color: var(--ok); }

    .reveal {
      display:none;
      border-top:1px solid var(--border);
      padding: 28px;
      text-align:center;
    }
    .reveal.show { display:block; }

    .finalCode {
      font-size: 48px;
      letter-spacing: 8px;
      font-weight: 900;
      margin-top:12px;
    }

    video {
      display:none;
    }
  </style>
</head>

<body>
<div class="wrap">
  <div class="topbar">
    <div class="badge">
      <span class="dot" id="dot"></span>
      <span><strong>Intentos:</strong> <span id="tries">3</span></span>
    </div>
    <div class="badge">
      <strong>Portal · Nochebuena</strong>
    </div>
  </div>

  <div class="card">
    <div class="hero">
      <h1>Introduce el código de 6 dígitos</h1>
    </div>

    <div class="inputs">
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
      <input class="pin" maxlength="1" inputmode="numeric" />
    </div>

    <div class="actions">
      <button id="checkBtn">Abrir portal</button>
      <button id="clearBtn" class="ghost">Borrar</button>
    </div>

    <div class="msg" id="msg"></div>

    <div class="reveal" id="reveal">
      <h2>Acceso concedido ✅</h2>
      <div class="finalCode" id="finalCode">---</div>
    </div>
  </div>
</div>

<video id="video">
  <source src="outro.mp4" type="video/mp4">
</video>

<script>
  const SECRET_6 = "220701";
  const FINAL_3 = "591";
  let tries = 3;

  const inputs = [...document.querySelectorAll(".pin")];
  const msg = document.getElementById("msg");
  const reveal = document.getElementById("reveal");
  const finalCode = document.getElementById("finalCode");
  const triesEl = document.getElementById("tries");
  const dot = document.getElementById("dot");
  const video = document.getElementById("video");

  function updateTries(){
    triesEl.textContent = tries;
    dot.style.background = tries > 1 ? "#b8c0ff" : tries === 1 ? "#ffd36a" : "#ff5a7a";
  }

  function getCode(){
    return inputs.map(i => i.value).join("");
  }

  function clearAll(){
    inputs.forEach(i => i.value = "");
    inputs[0].focus();
  }

  async function playFullscreenVideo() {
    video.style.display = "block";
    video.currentTime = 0;

    try {
      if (video.requestFullscreen) await video.requestFullscreen();
      else if (video.webkitRequestFullscreen) video.webkitRequestFullscreen();
    } catch(e){}

    video.play();

    video.onended = () => {
      if (document.fullscreenElement) document.exitFullscreen();
      video.pause();
      video.style.display = "none";
    };
  }

  document.getElementById("checkBtn").onclick = async () => {
    if (getCode().length < 6) {
      msg.textContent = "Completa los 6 dígitos";
      msg.className = "msg error";
      return;
    }

    if (getCode() === SECRET_6) {
      msg.textContent = "¡Correcto!";
      msg.className = "msg ok";
      finalCode.textContent = FINAL_3;
      reveal.classList.add("show");

      await playFullscreenVideo();
    } else {
      tries--;
      updateTries();
      msg.textContent = "Código incorrecto";
      msg.className = "msg error";
      clearAll();
      if (tries <= 0) {
        msg.textContent = "Portal bloqueado";
        inputs.forEach(i => i.disabled = true);
      }
    }
  };

  document.getElementById("clearBtn").onclick = clearAll;

  inputs.forEach((input, i) => {
    input.oninput = () => {
      input.value = input.value.replace(/\D/g,"");
      if (input.value && i < inputs.length-1) inputs[i+1].focus();
    };
  });

  updateTries();
  inputs[0].focus();
</script>

</body>
</html>
